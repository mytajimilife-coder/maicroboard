# MicroBoard 功能文档

## 📋 目录

- [核心功能](#核心功能)
- [公告板系统](#公告板系统)
- [会员管理](#会员管理)
- [社交登录](#社交登录)
- [积分系统](#积分系统)
- [插件系统](#插件系统)
- [多语言支持](#多语言支持)
- [管理员功能](#管理员功能)
- [安全功能](#安全功能)

---

## 🌟 核心功能

MicroBoard 是一个轻量级、高性能的公告板系统，允许您在没有复杂的大型 CMS 的情况下构建强大的社区平台。

### 主要特征

- ⚡ **轻量 & 快速**: 优化性能，最小化依赖
- 🌍 **全球支持**: 支持 4 种语言（韩语、英语、日语、中文）
- 🔐 **强大安全性**: CSRF、SQL 注入、XSS 保护
- 📱 **响应式设计**: 在所有设备上提供完美的用户体验
- 🔌 **可扩展**: 通过插件系统无限扩展

---

## 📝 公告板系统

### 基本公告板功能

MicroBoard 的公告板提供直观且强大的功能。

#### ✨ 发帖

- **WYSIWYG 编辑器**: 使用 Summernote 编辑器进行富文本编辑
- **图片上传**: 通过拖放轻松附加图片
- **文件附件**: 支持各种文件格式
- **实时预览**: 创建过程中立即预览

#### 🔍 搜索功能

- **集成搜索**: 按标题、内容和作者搜索
- **过滤**: 选择特定字段进行搜索
- **排序**: 按最新或浏览量排序

#### 💬 评论系统

- **分层评论**: 支持评论和回复
- **实时注册**: 无需刷新页面即可发布评论
- **作者显示**: 显示评论作者信息

#### 📊 浏览量跟踪

- **IP 基础重复预防**: 防止重复浏览量
- **实时聚合**: 实时更新浏览量

#### 📂 文件管理

- **多文件附件**: 同时上传多个文件
- **文件下载**: 下载和计数附件文件
- **自动清理**: 删除帖子时自动删除相关文件

#### 📋 公告板目录

- **卡片布局**: 卡片式列表，一目了然地查看所有公告板
- **响应式设计**: 即使在移动设备上也能清晰显示的网格系统
- **自动生成**: 添加公告板时自动反映在列表中

---

## 👥 会员管理

### 会员注册和认证

#### 📋 会员注册

- **简单注册流程**: 仅需 ID 和密码即可注册
- **实时重复检查**: 立即检查 ID 是否重复
- **密码加密**: 使用 bcrypt 安全存储密码
- **输入验证**: 通过服务器端输入值验证增强安全性

#### 🔐 登录系统

- **会话管理**: 安全的基于会话的认证
- **自动注销**: 30 分钟不活动后自动注销
- **记住我**: 保持登录状态的选项
- **多种登录方式**: 普通登录 + 社交登录

### 会员等级系统

#### 🏆 等级管理

- **10 级系统**: 1~10 级的会员等级系统
- **基于等级的权限**: 基于等级的公告板访问控制
- **自动晋升**: 基于活动积分自动调整等级（可选）
- **手动管理**: 管理员可以直接调整等级

#### 🚫 会员制裁

- **封禁功能**: 封禁有问题的会员
- **封禁原因记录**: 记录封禁原因和日期
- **解封**: 管理员可以随时解封
- **自动通知**: 向被封禁会员显示原因

#### 👤 会员资料

- **活动记录**: 查看已发布的帖子和评论
- **积分记录**: 详细记录获得/扣除的积分
- **注册信息**: 显示注册日期和最后登录日期

---

## 🔐 社交登录 (OAuth)

MicroBoard 提供与主要社交平台的无缝集成。

### 支持平台

#### 🔵 Google OAuth

- **Google 账户登录**: 使用 Google 账户一键登录
- **自动账户创建**: 首次登录时自动创建会员
- **资料集成**: 自动获取 Google 资料信息
- **设置**: 在[Google Cloud Console](https://console.cloud.google.com/)中配置

#### 🟢 LINE OAuth

- **LINE 账户登录**: 与 LINE 应用集成的登录
- **移动优化**: 适用于移动环境的登录流程
- **自动账户创建**: 首次登录时自动创建会员
- **设置**: 在[LINE Developers](https://developers.line.biz/)中配置

#### ⚫ Apple OAuth

- **使用 Apple 登录**: 使用 Apple ID 进行安全登录
- **隐私保护**: Apple 的强大隐私保护功能
- **iOS 优化**: 在 iOS/macOS 设备上提供优化体验
- **设置**: 在[Apple Developer](https://developer.apple.com/)中配置

### OAuth 功能

- ✅ **自动按钮显示**: 配置完成后自动显示登录按钮
- ✅ **状态显示**: 在管理员页面中检查 OAuth 配置状态
- ✅ **CSRF 保护**: 通过 State 参数防止 CSRF 攻击
- ✅ **错误处理**: 详细的错误消息和日志记录
- ✅ **多语言支持**: 在所有 OAuth 流程中提供多语言支持

### 设置方法

1. 访问管理员页面 (`/admin/oauth.php`)
2. 输入每个平台的 Client ID 和 Secret
3. 选择启用复选框
4. 保存后将自动显示登录按钮

---

## ⭐ 积分系统

鼓励会员活动的积分系统。

### 积分累积

#### 📝 发帖

- **自动累积**: 发帖时自动累积积分
- **管理员设置**: 管理员可以设置累积积分
- **差异累积**: 每个公告板不同的积分设置（可选）

#### 💬 评论

- **评论积分**: 评论时累积积分（可选）
- **鼓励活动**: 鼓励积极的社区参与

### 积分扣除

#### 🗑️ 删除帖子

- **自动扣除**: 删除帖子时自动扣除累积的积分
- **防止滥用**: 防止通过重复发布/删除来累积积分

### 积分管理

#### 📊 积分记录

- **详细记录**: 记录所有积分累积/扣除记录
- **按日期查看**: 按日期查看积分记录
- **原因显示**: 清楚显示积分变动原因

#### ⚙️ 管理员设置

- **开/关**: 启用/禁用积分系统
- **积分设置**: 设置帖子/评论的积分
- **手动授予**: 管理员可以直接授予/扣除积分

---

## 🔌 插件系统

MicroBoard 提供强大的基于钩子的插件系统。

### 插件结构

#### 📁 插件目录

```
/plugin
  /your_plugin_name
    - plugin.php (主插件文件)
    - config.json (插件设置)
    - README.md (插件说明)
```

### 钩子系统

#### 🎯 事件钩子

MicroBoard 在各种时机执行钩子:

- `before_write`: 发帖前
- `after_write`: 发帖后
- `before_delete`: 删除帖子前
- `after_delete`: 删除帖子后
- `before_comment`: 评论前
- `after_comment`: 评论后
- `before_login`: 登录前
- `after_login`: 登录后

#### 📌 插件注册

```php
// plugin.php示例
add_event('after_write', function($post_data) {
    // 发帖后执行的代码
    error_log("新帖子已创建: " . $post_data['title']);
}, 10); // 优先级10
```

### 插件功能

#### ⚙️ 插件管理

- **自动加载**: 自动识别`/plugin`文件夹中的插件
- **启用/禁用**: 在管理员页面中开启/关闭插件
- **按公告板应用**: 仅在特定公告板上应用插件
- **优先级**: 控制多个插件的执行顺序

#### 🛠️ 插件示例

```php
<?php
/**
 * Plugin Name: Hello World
 * Description: 简单的插件示例
 * Version: 1.0.0
 */

// 发帖后记录日志
add_event('after_write', function($post_data) {
    $log = "[" . date('Y-m-d H:i:s') . "] ";
    $log .= "新帖子: " . $post_data['title'];
    file_put_contents(__DIR__ . '/log.txt', $log . PHP_EOL, FILE_APPEND);
});

// 评论时通知
add_event('after_comment', function($comment_data) {
    // 实现电子邮件通知、推送通知等
    notify_admin($comment_data);
});
?>
```

---

## 🌍 多语言支持

MicroBoard 为全球服务提供完美的多语言支持。

### 支持语言

#### 🇰🇷 韩语 (Korean)

- 完美的韩语翻译
- 韩国式日期/时间格式
- 适用于韩国服务

#### 🇺🇸 英语 (English)

- 本地级别的英语翻译
- 国际标准日期/时间格式
- 全球服务支持

#### 🇯🇵 日语 (Japanese)

- 自然的日语翻译
- 日式敬语表达
- 适用于日本服务

#### 🇨🇳 中文 (Chinese)

- 精确的中文翻译（简体）
- 中式表达方式
- 适用于中国服务

### 多语言功能

#### 🔄 自动语言检测

- **浏览器语言**: 自动检测用户浏览器设置
- **IP 基础**: 通过 IP 地址确定国家（可选）
- **Cookie 存储**: 自动保存所选语言

#### 🎛️ 语言切换

- **语言选择器**: 所有页面上的语言选择菜单
- **即时切换**: 无需刷新页面即可更改语言
- **URL 参数**: 以`?lang=ko`格式指定语言

#### 📝 翻译管理

- **语言文件**: `/lang/`文件夹中的特定语言 PHP 文件
- **轻松添加**: 仅通过添加新语言文件即可扩展语言
- **覆盖**: 可以自定义特定短语

---

## 👨‍💼 管理员功能

提供强大且直观的管理员页面。

### 仪表板

#### 📊 统计

- **会员统计**: 总会员数、新注册、活跃会员
- **帖子统计**: 总帖子数、每日帖子数
- **访问者统计**: 每日访问者数、页面浏览量
- **系统信息**: 服务器状态、磁盘使用量

### 会员管理

#### 👥 会员列表

- **查看所有会员**: 按注册日期或名称排序
- **详细信息**: 每个会员的活动记录和积分
- **批量操作**: 同时管理多个会员

#### 🔧 会员控制

- **等级更改**: 批量或单独更改等级
- **封禁/解封**: 封禁和解封有问题的会员账户
- **删除**: 完全删除会员及相关数据
- **积分管理**: 手动授予/扣除积分

### 公告板管理

#### 📋 公告板设置

- **创建公告板**: 创建新公告板
- **权限设置**: 设置读取/写入权限级别
- **皮肤选择**: 每个公告板应用不同的皮肤
- **列表数量**: 设置每页显示的帖子数

#### 🎨 皮肤管理

- **皮肤列表**: 查看已安装皮肤的列表
- **预览**: 应用皮肤前的预览
- **设置**: 设置每个皮肤的详细选项

### OAuth 管理

#### 🔐 OAuth 设置

- **Google 设置**: 输入 Client ID、Secret 并启用
- **LINE 设置**: 管理 Channel ID、Secret
- **Apple 设置**: 管理 Team ID、Key ID、Private Key
- **状态检查**: 实时检查 OAuth 集成状态

### 系统设置

#### ⚙️ 基本设置

- **站点标题**: 站点名称和描述
- **管理员电子邮件**: 系统通知接收电子邮件
- **默认语言**: 设置站点默认语言
- **时区**: 设置服务器时区

#### 💰 积分设置

- **积分使用**: 开启/关闭积分系统
- **帖子积分**: 发帖时授予的积分
- **评论积分**: 评论时授予的积分
- **登录积分**: 每日登录奖励积分

### 政策管理

#### 📜 政策页面和自动安装

- **自动安装**: 安装时自动注册 4 种语言（韩/英/日/中）的服务条款和隐私政策
- **自动显示**: 根据用户的语言设置自动显示相应语言的政策
- **服务条款**: 创建/编辑服务条款
- **隐私政策**: 管理隐私政策
- **WYSIWYG 编辑器**: 政策内容编辑器
- **版本管理**: 保存政策变更记录

---

## 🔒 安全功能

MicroBoard 使用最新的安全技术保护您的站点。

### 认证安全

#### 🔐 密码安全

- **bcrypt 加密**: 行业标准的密码哈希
- **盐**: 自动生成盐以防止彩虹表攻击
- **重新哈希**: 密码更改时自动重新哈希

#### ⏰ 会话安全

- **会话超时**: 30 分钟不活动后自动注销
- **会话再生成**: 登录时重新生成会话 ID
- **安全 Cookie**: 在 HTTPS 环境中使用安全标志

### 输入安全

#### 🛡️ SQL 注入防止

- **PDO 预处理语句**: 在所有查询中使用预处理语句
- **输入验证**: 服务器端验证所有用户输入
- **类型检查**: 严格验证数据类型（数字/字符串等）

#### 🚫 XSS 防止

- **htmlspecialchars**: 输出时转义所有 HTML
- **DOM Purify**: 客户端 XSS 防止
- **内容安全策略**: 通过 CSP 头阻止脚本注入

#### 🔒 CSRF 防止

- **CSRF 令牌**: 在所有表单中自动生成 CSRF 令牌
- **令牌验证**: 提交表单时验证令牌
- **SameSite Cookie**: 设置 Cookie 的 SameSite 属性

### 文件安全

#### 📁 上传安全

- **文件类型验证**: 基于白名单的文件扩展名验证
- **文件大小限制**: 最大上传大小限制
- **随机化文件名**: 自动更改上传的文件名
- **执行防止**: 阻止上传目录中的脚本执行

### 访问控制

#### 🚪 权限管理

- **基于级别的访问**: 基于会员等级的访问控制
- **管理员认证**: 管理页面的双重认证
- **IP 白名单**: 仅允许特定 IP 访问管理员（可选）

---

## 📦 附加功能

### 📮 电子邮件通知（可选）

- 会员注册欢迎邮件
- 评论通知邮件
- 密码重置邮件
- 管理员通知邮件

### 🔍 SEO 优化

- 自动生成元标签
- 自动生成站点地图
- Robots.txt 管理
- URL 结构优化

### 📊 日志记录

- 错误日志记录
- 访问日志记录
- 管理员操作日志
- 日志保留和删除策略

---

## 🚀 性能优化

### ⚡ 缓存

- 数据库查询缓存
- 页面缓存（可选）
- 静态文件缓存

### 📉 优化

- 自动图像压缩
- CSS/JS 压缩和合并
- 懒加载
- CDN 支持

---

## 📱 移动支持

### 📲 响应式设计

- **完美响应式**: 适用于所有屏幕尺寸
- **触摸优化**: 支持触摸界面
- **移动菜单**: 移动专用导航
- **快速加载**: 适用于移动环境

---

## 🔄 更新和迁移

### 📥 更新

- **自动更新检查**: 自动检测新版本
- **一键更新**: 通过一个按钮更新
- **自动备份**: 更新前自动备份

### 🔄 迁移

- **数据库迁移**: 按版本自动更新 DB 架构
- **设置保留**: 保留现有设置和数据
- **回滚支持**: 问题发生时恢复到之前版本

---

## 📞 支持和社区

### 💬 支持

- **GitHub Issues**: 错误报告和功能请求
- **文档**: 详细的在线文档
- **FAQ**: 常见问题

### 🤝 社区

- **GitHub Discussions**: 社区讨论
- **贡献指南**: 开源贡献方法
- **插件共享**: 社区插件

---

## 📄 许可证

MicroBoard 根据[MIT 许可证](LICENSE)发布。

---

**MicroBoard v1.0.0** | [Documentation](https://mytajimilife-coder.github.io/microboard/) | [GitHub](https://github.com/mytajimilife-coder/microboard)
